{"version":3,"sources":["cEngine.file.js"],"names":["e","t","n","r","s","o","u","a","require","i","Error","f","exports","call","length",1,"module","_interopRequireDefault","obj","__esModule","default","_FileSaver","_FileSaver2","cEngine","extend","version","create","file","cEnginePlugin","engine","undefined","fileInput","init","document","createElement","type","style","visibility","body","appendChild","onclick","this","value","onchange","fr","FileReader","onload","img","Image","clear","resizeTo","width","height","canvas","getContext","drawImage","src","result","readAsDataURL","files","saveToFile","name","toBlob","blob","saveAs","loadFile","click","../vendors/FileSaver","../vendors/canvas-toBlob",2,"view","navigator","test","userAgent","doc","get_URL","URL","webkitURL","save_link","createElementNS","can_use_save_link","node","event","MouseEvent","dispatchEvent","is_safari","webkit_req_fs","webkitRequestFileSystem","req_fs","requestFileSystem","mozRequestFileSystem","throw_outside","ex","setImmediate","setTimeout","force_saveable_type","fs_min_size","arbitrary_revoke_timeout","revoke","revoker","revokeObjectURL","remove","chrome","dispatch","filesaver","event_types","concat","listener","auto_bom","Blob","FileSaver","no_auto_bom","object_url","target_view","slice","blob_changed","dispatch_all","split","fs_error","reader","onloadend","base64Data","location","href","search","readyState","DONE","INIT","createObjectURL","new_tab","open","abortable","func","apply","arguments","create_if_not_found","exclusive","download","webkitSlice","size","TEMPORARY","fs","root","getDirectory","dir","save","getFile","createWriter","writer","onwriteend","toURL","onerror","error","code","ABORT_ERR","forEach","write","abort","WRITING","NOT_FOUND_ERR","FS_proto","prototype","msSaveOrOpenBlob","onwritestart","onprogress","onwrite","onabort","self","window","content","define","amd",3,"base64_ranks","Uint8Array","HTMLCanvasElement","canvas_proto","is_base64_regex","to_data_url","decode_base64","base64","rank","undef","len","buffer","outptr","last","state","charCodeAt","callback","mozGetAsFile","msToBlob","args","Array","dataURI","header_end","indexOf","data","substring","is_base64","fake","encoding","decodeURIComponent","toDataURLHD","toBlobHD"],"mappings":"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","file":"cEngine.file-min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar _FileSaver = require('../vendors/FileSaver');\n\nvar _FileSaver2 = _interopRequireDefault(_FileSaver);\n\nrequire('../vendors/canvas-toBlob');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/*global cEngine */\n\n(function (cEngine) {\n\n  cEngine.extend('file', {\n    version: '0.0.1',\n    create: function create() {\n\n      var file = {\n        cEnginePlugin: true,\n        engine: undefined,\n        fileInput: undefined,\n        init: function init(engine) {\n          file.engine = engine;\n          file.fileInput = document.createElement('input');\n          file.fileInput.type = \"file\";\n          file.fileInput.style.visibility = 'hidden';\n          document.body.appendChild(file.fileInput);\n\n          file.fileInput.onclick = function () {\n            this.value = null;\n          };\n\n          file.fileInput.onchange = function () {\n\n            var fr = new FileReader();\n            fr.onload = function () {\n              var img = new Image();\n              img.onload = function () {\n                file.engine.clear();\n                file.engine.resizeTo(img.width, img.height);\n                file.engine.canvas.getContext(\"2d\").drawImage(img, 0, 0);\n              };\n              img.src = fr.result;\n            };\n\n            fr.readAsDataURL(file.fileInput.files[0]);\n          };\n        },\n        saveToFile: function saveToFile(name) {\n          file.engine.canvas.toBlob(function (blob) {\n            _FileSaver2.default.saveAs(blob, name);\n          });\n        },\n        loadFile: function loadFile() {\n          file.fileInput.click();\n        }\n      };\n\n      return file;\n    }\n  });\n})(cEngine);\n},{\"../vendors/FileSaver\":2,\"../vendors/canvas-toBlob\":3}],2:[function(require,module,exports){\n/* FileSaver.js\n * A saveAs() FileSaver implementation.\n * 1.1.20160319\n *\n * By Eli Grey, http://eligrey.com\n * License: MIT\n *   See https://github.com/eligrey/FileSaver.js/blob/master/LICENSE.md\n */\n\n/*global self */\n/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */\n\n/*! @source http://purl.eligrey.com/github/FileSaver.js/blob/master/FileSaver.js */\n\nvar saveAs = saveAs || (function(view) {\n\t\"use strict\";\n\t// IE <10 is explicitly unsupported\n\tif (typeof navigator !== \"undefined\" && /MSIE [1-9]\\./.test(navigator.userAgent)) {\n\t\treturn;\n\t}\n\tvar\n\t\t  doc = view.document\n\t\t  // only get URL when necessary in case Blob.js hasn't overridden it yet\n\t\t, get_URL = function() {\n\t\t\treturn view.URL || view.webkitURL || view;\n\t\t}\n\t\t, save_link = doc.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\")\n\t\t, can_use_save_link = \"download\" in save_link\n\t\t, click = function(node) {\n\t\t\tvar event = new MouseEvent(\"click\");\n\t\t\tnode.dispatchEvent(event);\n\t\t}\n\t\t, is_safari = /Version\\/[\\d\\.]+.*Safari/.test(navigator.userAgent)\n\t\t, webkit_req_fs = view.webkitRequestFileSystem\n\t\t, req_fs = view.requestFileSystem || webkit_req_fs || view.mozRequestFileSystem\n\t\t, throw_outside = function(ex) {\n\t\t\t(view.setImmediate || view.setTimeout)(function() {\n\t\t\t\tthrow ex;\n\t\t\t}, 0);\n\t\t}\n\t\t, force_saveable_type = \"application/octet-stream\"\n\t\t, fs_min_size = 0\n\t\t// See https://code.google.com/p/chromium/issues/detail?id=375297#c7 and\n\t\t// https://github.com/eligrey/FileSaver.js/commit/485930a#commitcomment-8768047\n\t\t// for the reasoning behind the timeout and revocation flow\n\t\t, arbitrary_revoke_timeout = 500 // in ms\n\t\t, revoke = function(file) {\n\t\t\tvar revoker = function() {\n\t\t\t\tif (typeof file === \"string\") { // file is an object URL\n\t\t\t\t\tget_URL().revokeObjectURL(file);\n\t\t\t\t} else { // file is a File\n\t\t\t\t\tfile.remove();\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (view.chrome) {\n\t\t\t\trevoker();\n\t\t\t} else {\n\t\t\t\tsetTimeout(revoker, arbitrary_revoke_timeout);\n\t\t\t}\n\t\t}\n\t\t, dispatch = function(filesaver, event_types, event) {\n\t\t\tevent_types = [].concat(event_types);\n\t\t\tvar i = event_types.length;\n\t\t\twhile (i--) {\n\t\t\t\tvar listener = filesaver[\"on\" + event_types[i]];\n\t\t\t\tif (typeof listener === \"function\") {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlistener.call(filesaver, event || filesaver);\n\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\tthrow_outside(ex);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t, auto_bom = function(blob) {\n\t\t\t// prepend BOM for UTF-8 XML and text/* types (including HTML)\n\t\t\tif (/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n\t\t\t\treturn new Blob([\"\\ufeff\", blob], {type: blob.type});\n\t\t\t}\n\t\t\treturn blob;\n\t\t}\n\t\t, FileSaver = function(blob, name, no_auto_bom) {\n\t\t\tif (!no_auto_bom) {\n\t\t\t\tblob = auto_bom(blob);\n\t\t\t}\n\t\t\t// First try a.download, then web filesystem, then object URLs\n\t\t\tvar\n\t\t\t\t  filesaver = this\n\t\t\t\t, type = blob.type\n\t\t\t\t, blob_changed = false\n\t\t\t\t, object_url\n\t\t\t\t, target_view\n\t\t\t\t, dispatch_all = function() {\n\t\t\t\t\tdispatch(filesaver, \"writestart progress write writeend\".split(\" \"));\n\t\t\t\t}\n\t\t\t\t// on any filesys errors revert to saving with object URLs\n\t\t\t\t, fs_error = function() {\n\t\t\t\t\tif (target_view && is_safari && typeof FileReader !== \"undefined\") {\n\t\t\t\t\t\t// Safari doesn't allow downloading of blob urls\n\t\t\t\t\t\tvar reader = new FileReader();\n\t\t\t\t\t\treader.onloadend = function() {\n\t\t\t\t\t\t\tvar base64Data = reader.result;\n\t\t\t\t\t\t\ttarget_view.location.href = \"data:attachment/file\" + base64Data.slice(base64Data.search(/[,;]/));\n\t\t\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\t\t\tdispatch_all();\n\t\t\t\t\t\t};\n\t\t\t\t\t\treader.readAsDataURL(blob);\n\t\t\t\t\t\tfilesaver.readyState = filesaver.INIT;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// don't create more object URLs than needed\n\t\t\t\t\tif (blob_changed || !object_url) {\n\t\t\t\t\t\tobject_url = get_URL().createObjectURL(blob);\n\t\t\t\t\t}\n\t\t\t\t\tif (target_view) {\n\t\t\t\t\t\ttarget_view.location.href = object_url;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar new_tab = view.open(object_url, \"_blank\");\n\t\t\t\t\t\tif (new_tab === undefined && is_safari) {\n\t\t\t\t\t\t\t//Apple do not allow window.open, see http://bit.ly/1kZffRI\n\t\t\t\t\t\t\tview.location.href = object_url\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\tdispatch_all();\n\t\t\t\t\trevoke(object_url);\n\t\t\t\t}\n\t\t\t\t, abortable = function(func) {\n\t\t\t\t\treturn function() {\n\t\t\t\t\t\tif (filesaver.readyState !== filesaver.DONE) {\n\t\t\t\t\t\t\treturn func.apply(this, arguments);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t, create_if_not_found = {create: true, exclusive: false}\n\t\t\t\t, slice\n\t\t\t;\n\t\t\tfilesaver.readyState = filesaver.INIT;\n\t\t\tif (!name) {\n\t\t\t\tname = \"download\";\n\t\t\t}\n\t\t\tif (can_use_save_link) {\n\t\t\t\tobject_url = get_URL().createObjectURL(blob);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tsave_link.href = object_url;\n\t\t\t\t\tsave_link.download = name;\n\t\t\t\t\tclick(save_link);\n\t\t\t\t\tdispatch_all();\n\t\t\t\t\trevoke(object_url);\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Object and web filesystem URLs have a problem saving in Google Chrome when\n\t\t\t// viewed in a tab, so I force save with application/octet-stream\n\t\t\t// http://code.google.com/p/chromium/issues/detail?id=91158\n\t\t\t// Update: Google errantly closed 91158, I submitted it again:\n\t\t\t// https://code.google.com/p/chromium/issues/detail?id=389642\n\t\t\tif (view.chrome && type && type !== force_saveable_type) {\n\t\t\t\tslice = blob.slice || blob.webkitSlice;\n\t\t\t\tblob = slice.call(blob, 0, blob.size, force_saveable_type);\n\t\t\t\tblob_changed = true;\n\t\t\t}\n\t\t\t// Since I can't be sure that the guessed media type will trigger a download\n\t\t\t// in WebKit, I append .download to the filename.\n\t\t\t// https://bugs.webkit.org/show_bug.cgi?id=65440\n\t\t\tif (webkit_req_fs && name !== \"download\") {\n\t\t\t\tname += \".download\";\n\t\t\t}\n\t\t\tif (type === force_saveable_type || webkit_req_fs) {\n\t\t\t\ttarget_view = view;\n\t\t\t}\n\t\t\tif (!req_fs) {\n\t\t\t\tfs_error();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfs_min_size += blob.size;\n\t\t\treq_fs(view.TEMPORARY, fs_min_size, abortable(function(fs) {\n\t\t\t\tfs.root.getDirectory(\"saved\", create_if_not_found, abortable(function(dir) {\n\t\t\t\t\tvar save = function() {\n\t\t\t\t\t\tdir.getFile(name, create_if_not_found, abortable(function(file) {\n\t\t\t\t\t\t\tfile.createWriter(abortable(function(writer) {\n\t\t\t\t\t\t\t\twriter.onwriteend = function(event) {\n\t\t\t\t\t\t\t\t\ttarget_view.location.href = file.toURL();\n\t\t\t\t\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\t\t\t\t\tdispatch(filesaver, \"writeend\", event);\n\t\t\t\t\t\t\t\t\trevoke(file);\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\twriter.onerror = function() {\n\t\t\t\t\t\t\t\t\tvar error = writer.error;\n\t\t\t\t\t\t\t\t\tif (error.code !== error.ABORT_ERR) {\n\t\t\t\t\t\t\t\t\t\tfs_error();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\"writestart progress write abort\".split(\" \").forEach(function(event) {\n\t\t\t\t\t\t\t\t\twriter[\"on\" + event] = filesaver[\"on\" + event];\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\twriter.write(blob);\n\t\t\t\t\t\t\t\tfilesaver.abort = function() {\n\t\t\t\t\t\t\t\t\twriter.abort();\n\t\t\t\t\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tfilesaver.readyState = filesaver.WRITING;\n\t\t\t\t\t\t\t}), fs_error);\n\t\t\t\t\t\t}), fs_error);\n\t\t\t\t\t};\n\t\t\t\t\tdir.getFile(name, {create: false}, abortable(function(file) {\n\t\t\t\t\t\t// delete file if it already exists\n\t\t\t\t\t\tfile.remove();\n\t\t\t\t\t\tsave();\n\t\t\t\t\t}), abortable(function(ex) {\n\t\t\t\t\t\tif (ex.code === ex.NOT_FOUND_ERR) {\n\t\t\t\t\t\t\tsave();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfs_error();\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t}), fs_error);\n\t\t\t}), fs_error);\n\t\t}\n\t\t, FS_proto = FileSaver.prototype\n\t\t, saveAs = function(blob, name, no_auto_bom) {\n\t\t\treturn new FileSaver(blob, name, no_auto_bom);\n\t\t}\n\t;\n\t// IE 10+ (native saveAs)\n\tif (typeof navigator !== \"undefined\" && navigator.msSaveOrOpenBlob) {\n\t\treturn function(blob, name, no_auto_bom) {\n\t\t\tif (!no_auto_bom) {\n\t\t\t\tblob = auto_bom(blob);\n\t\t\t}\n\t\t\treturn navigator.msSaveOrOpenBlob(blob, name || \"download\");\n\t\t};\n\t}\n\n\tFS_proto.abort = function() {\n\t\tvar filesaver = this;\n\t\tfilesaver.readyState = filesaver.DONE;\n\t\tdispatch(filesaver, \"abort\");\n\t};\n\tFS_proto.readyState = FS_proto.INIT = 0;\n\tFS_proto.WRITING = 1;\n\tFS_proto.DONE = 2;\n\n\tFS_proto.error =\n\tFS_proto.onwritestart =\n\tFS_proto.onprogress =\n\tFS_proto.onwrite =\n\tFS_proto.onabort =\n\tFS_proto.onerror =\n\tFS_proto.onwriteend =\n\t\tnull;\n\n\treturn saveAs;\n}(\n\t   typeof self !== \"undefined\" && self\n\t|| typeof window !== \"undefined\" && window\n\t|| this.content\n));\n// `self` is undefined in Firefox for Android content script context\n// while `this` is nsIContentFrameMessageManager\n// with an attribute `content` that corresponds to the window\n\nif (typeof module !== \"undefined\" && module.exports) {\n  module.exports.saveAs = saveAs;\n} else if ((typeof define !== \"undefined\" && define !== null) && (define.amd !== null)) {\n  define([], function() {\n    return saveAs;\n  });\n}\n\n},{}],3:[function(require,module,exports){\n/* canvas-toBlob.js\n * A canvas.toBlob() implementation.\n * 2013-12-27\n * \n * By Eli Grey, http://eligrey.com and Devin Samarin, https://github.com/eboyjr\n * License: MIT\n *   See https://github.com/eligrey/canvas-toBlob.js/blob/master/LICENSE.md\n */\n\n/*global self */\n/*jslint bitwise: true, regexp: true, confusion: true, es5: true, vars: true, white: true,\n  plusplus: true */\n\n/*! @source http://purl.eligrey.com/github/canvas-toBlob.js/blob/master/canvas-toBlob.js */\n\n(function(view) {\n\"use strict\";\nvar\n\t  Uint8Array = view.Uint8Array\n\t, HTMLCanvasElement = view.HTMLCanvasElement\n\t, canvas_proto = HTMLCanvasElement && HTMLCanvasElement.prototype\n\t, is_base64_regex = /\\s*;\\s*base64\\s*(?:;|$)/i\n\t, to_data_url = \"toDataURL\"\n\t, base64_ranks\n\t, decode_base64 = function(base64) {\n\t\tvar\n\t\t\t  len = base64.length\n\t\t\t, buffer = new Uint8Array(len / 4 * 3 | 0)\n\t\t\t, i = 0\n\t\t\t, outptr = 0\n\t\t\t, last = [0, 0]\n\t\t\t, state = 0\n\t\t\t, save = 0\n\t\t\t, rank\n\t\t\t, code\n\t\t\t, undef\n\t\t;\n\t\twhile (len--) {\n\t\t\tcode = base64.charCodeAt(i++);\n\t\t\trank = base64_ranks[code-43];\n\t\t\tif (rank !== 255 && rank !== undef) {\n\t\t\t\tlast[1] = last[0];\n\t\t\t\tlast[0] = code;\n\t\t\t\tsave = (save << 6) | rank;\n\t\t\t\tstate++;\n\t\t\t\tif (state === 4) {\n\t\t\t\t\tbuffer[outptr++] = save >>> 16;\n\t\t\t\t\tif (last[1] !== 61 /* padding character */) {\n\t\t\t\t\t\tbuffer[outptr++] = save >>> 8;\n\t\t\t\t\t}\n\t\t\t\t\tif (last[0] !== 61 /* padding character */) {\n\t\t\t\t\t\tbuffer[outptr++] = save;\n\t\t\t\t\t}\n\t\t\t\t\tstate = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// 2/3 chance there's going to be some null bytes at the end, but that\n\t\t// doesn't really matter with most image formats.\n\t\t// If it somehow matters for you, truncate the buffer up outptr.\n\t\treturn buffer;\n\t}\n;\nif (Uint8Array) {\n\tbase64_ranks = new Uint8Array([\n\t\t  62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1\n\t\t, -1, -1,  0, -1, -1, -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9\n\t\t, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25\n\t\t, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35\n\t\t, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51\n\t]);\n}\nif (HTMLCanvasElement && !canvas_proto.toBlob) {\n\tcanvas_proto.toBlob = function(callback, type /*, ...args*/) {\n\t\t  if (!type) {\n\t\t\ttype = \"image/png\";\n\t\t} if (this.mozGetAsFile) {\n\t\t\tcallback(this.mozGetAsFile(\"canvas\", type));\n\t\t\treturn;\n\t\t} if (this.msToBlob && /^\\s*image\\/png\\s*(?:$|;)/i.test(type)) {\n\t\t\tcallback(this.msToBlob());\n\t\t\treturn;\n\t\t}\n\n\t\tvar\n\t\t\t  args = Array.prototype.slice.call(arguments, 1)\n\t\t\t, dataURI = this[to_data_url].apply(this, args)\n\t\t\t, header_end = dataURI.indexOf(\",\")\n\t\t\t, data = dataURI.substring(header_end + 1)\n\t\t\t, is_base64 = is_base64_regex.test(dataURI.substring(0, header_end))\n\t\t\t, blob\n\t\t;\n\t\tif (Blob.fake) {\n\t\t\t// no reason to decode a data: URI that's just going to become a data URI again\n\t\t\tblob = new Blob\n\t\t\tif (is_base64) {\n\t\t\t\tblob.encoding = \"base64\";\n\t\t\t} else {\n\t\t\t\tblob.encoding = \"URI\";\n\t\t\t}\n\t\t\tblob.data = data;\n\t\t\tblob.size = data.length;\n\t\t} else if (Uint8Array) {\n\t\t\tif (is_base64) {\n\t\t\t\tblob = new Blob([decode_base64(data)], {type: type});\n\t\t\t} else {\n\t\t\t\tblob = new Blob([decodeURIComponent(data)], {type: type});\n\t\t\t}\n\t\t}\n\t\tcallback(blob);\n\t};\n\n\tif (canvas_proto.toDataURLHD) {\n\t\tcanvas_proto.toBlobHD = function() {\n\t\t\tto_data_url = \"toDataURLHD\";\n\t\t\tvar blob = this.toBlob();\n\t\t\tto_data_url = \"toDataURL\";\n\t\t\treturn blob;\n\t\t}\n\t} else {\n\t\tcanvas_proto.toBlobHD = canvas_proto.toBlob;\n\t}\n}\n}(typeof self !== \"undefined\" && self || typeof window !== \"undefined\" && window || this.content || this));\n\n},{}]},{},[1])"],"sourceRoot":"/source/"}