{"version":3,"sources":["cEngine.input.js"],"names":["e","t","n","r","s","o","u","a","require","i","Error","f","exports","call","length","1","module","cEngine","MOUSE_LEFT_TOUCH","inputPlugin","create","config","input","cEnginePlugin","name","version","engine","undefined","keys","touches","init","window","canvas","addEventListener","touchstart","document","touchmove","touchend","mousedown","mousemove","mouseup","onKeydown","onKeyup","destroy","removeEventListener","event","which","preventDefault","mouseIsTouching","identifier","push","createTouch","idx","ongoingTouchIndexById","splice","changedTouches","idToFind","id","KeyCode","keyCode","touch","rect","getBoundingClientRect","newTouch","x","clientX","left","y","clientY","top","useResolutionDevider","resolutionDevider","27","32","37","38","39","40","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","extend"],"mappings":"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","file":"cEngine.input-min.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error(\"Cannot find module '\"+o+\"'\")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\n/*global cEngine */\n\n(function (cEngine) {\n\n  var MOUSE_LEFT_TOUCH = \"MOUSE_LEFT_TOUCH\";\n\n  var inputPlugin = {\n\n    create: function create(config) {\n      config = config || {};\n\n      var input = {\n\n        cEnginePlugin: {\n          name: 'inputPlugin',\n          version: '0.0.8'\n        },\n        engine: undefined,\n        keys: {},\n        touches: [],\n\n        init: function init(engine) {\n          input.engine = engine;\n\n          if ('ontouchstart' in window) {\n            input.engine.canvas.addEventListener('touchstart', input.touchstart);\n            window.document.addEventListener('touchmove', input.touchmove);\n            window.document.addEventListener('touchend', input.touchend);\n            window.document.addEventListener('touchcancel', input.touchend);\n          } else {\n            input.engine.canvas.addEventListener('mousedown', input.mousedown);\n            window.document.addEventListener('mousemove', input.mousemove);\n            window.document.addEventListener('mouseup', input.mouseup);\n          }\n          window.document.addEventListener('keydown', input.onKeydown);\n          window.document.addEventListener('keyup', input.onKeyup);\n        },\n\n        destroy: function destroy() {\n          input.engine.canvas.removeEventListener('touchstart', input.touchstart);\n          window.document.removeEventListener('touchmove', input.touchmove);\n          window.document.removeEventListener('touchend', input.touchend);\n          window.document.removeEventListener('touchcancel', input.touchend);\n\n          input.engine.canvas.removeEventListener('mousedown', input.mousedown);\n          window.document.removeEventListener('mousemove', input.mousemove);\n          window.document.removeEventListener('mouseup', input.mouseup);\n\n          window.document.removeEventListener('keydown', input.onKeydown);\n          window.document.removeEventListener('keyup', input.onKeyup);\n        },\n\n        mousedown: function mousedown(event) {\n          if (event.which == 1) {\n            event.preventDefault();\n            input.mouseIsTouching = true;\n            event.identifier = MOUSE_LEFT_TOUCH;\n            input.touches.push(input.createTouch(event));\n          }\n        },\n\n        mousemove: function mousemove(event) {\n          if (event.which == 1) {\n            event.preventDefault();\n            if (input.mouseIsTouching) {\n              event.identifier = MOUSE_LEFT_TOUCH;\n              var idx = input.ongoingTouchIndexById(event.identifier);\n              if (idx >= 0) {\n                input.touches.splice(idx, 1, input.createTouch(event)); // swap in the new touch record\n              }\n            }\n          }\n        },\n\n        mouseup: function mouseup(event) {\n          if (event.which == 1) {\n            event.preventDefault();\n            input.mouseIsTouching = false;\n            event.identifier = MOUSE_LEFT_TOUCH;\n            var idx = input.ongoingTouchIndexById(event.identifier);\n            if (idx >= 0) {\n              input.touches.splice(idx, 1); // remove it; we're done\n            }\n          }\n        },\n\n        touchstart: function touchstart(event) {\n          var touches = event.changedTouches;\n          for (var i = 0; i < touches.length; i++) {\n            input.touches.push(input.createTouch(touches[i]));\n          }\n        },\n\n        touchmove: function touchmove(event) {\n          var touches = event.changedTouches;\n          for (var i = 0; i < touches.length; i++) {\n            var idx = input.ongoingTouchIndexById(touches[i].identifier);\n            if (idx >= 0) {\n              input.touches.splice(idx, 1, input.createTouch(touches[i])); // swap in the new touch record\n            }\n          }\n        },\n\n        touchend: function touchend(event) {\n          var touches = event.changedTouches;\n          for (var i = 0; i < touches.length; i++) {\n            var idx = input.ongoingTouchIndexById(touches[i].identifier);\n            if (idx >= 0) {\n              input.touches.splice(idx, 1); // remove it; we're done\n            }\n          }\n        },\n\n        ongoingTouchIndexById: function ongoingTouchIndexById(idToFind) {\n          for (var i = 0; i < input.touches.length; i++) {\n            var id = input.touches[i].identifier;\n\n            if (id == idToFind) {\n              return i;\n            }\n          }\n          return -1; // not found\n        },\n\n        onKeydown: function onKeydown(event) {\n          input.keys[inputPlugin.KeyCode[event.keyCode]] = true;\n        },\n\n        onKeyup: function onKeyup(event) {\n          input.keys[inputPlugin.KeyCode[event.keyCode]] = false;\n        },\n\n        createTouch: function createTouch(touch) {\n          var rect = input.engine.canvas.getBoundingClientRect();\n          var newTouch = {\n            identifier: touch.identifier,\n            x: touch.clientX - rect.left,\n            y: touch.clientY - rect.top\n          };\n\n          if (input.engine.useResolutionDevider) {\n            newTouch.x = newTouch.x / input.engine.resolutionDevider;\n            newTouch.y = newTouch.y / input.engine.resolutionDevider;\n          }\n\n          return newTouch;\n        }\n      };\n\n      return input;\n    },\n\n    KeyCode: {\n      27: 'ESC',\n      32: 'SPACE',\n      37: 'LEFT',\n      38: 'UP',\n      39: 'RIGHT',\n      40: 'DOWN',\n      65: 'A',\n      66: 'B',\n      67: 'C',\n      68: 'D',\n      69: 'E',\n      70: 'F',\n      71: 'G',\n      72: 'H',\n      73: 'I',\n      74: 'J',\n      75: 'K',\n      76: 'L',\n      77: 'M',\n      78: 'N',\n      79: 'O',\n      80: 'P',\n      81: 'Q',\n      82: 'R',\n      83: 'S',\n      84: 'T',\n      85: 'U',\n      86: 'V',\n      87: 'W',\n      88: 'X',\n      89: 'Y',\n      90: 'Z'\n    }\n  };\n\n  cEngine.extend('input', inputPlugin);\n})(cEngine);\n},{}]},{},[1])"],"sourceRoot":"/source/"}